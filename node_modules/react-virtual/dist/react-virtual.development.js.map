{"version":3,"file":"react-virtual.development.js","sources":["../src/useScroll.js","../node_modules/@reach/observe-rect/dist/observe-rect.esm.js","../src/useIsomorphicLayoutEffect.js","../src/useRect.js","../src/index.js"],"sourcesContent":["import React from 'react'\n\nexport default function useScroll(ref, onChange) {\n  const onChangeRef = React.useRef()\n  onChangeRef.current = onChange\n\n  React.useEffect(() => {\n    const el = ref.current\n\n    const handler = e => {\n      onChangeRef.current({\n        scrollLeft: e.target.scrollLeft,\n        scrollTop: e.target.scrollTop,\n      })\n    }\n\n    if (el) {\n      el.addEventListener('scroll', handler, {\n        capture: false,\n        passive: true,\n      })\n\n      return () => {\n        el.removeEventListener('scroll', handler)\n      }\n    }\n  }, [ref])\n}\n","var props = ['bottom', 'height', 'left', 'right', 'top', 'width'];\n\nvar rectChanged = function rectChanged(a, b) {\n  if (a === void 0) {\n    a = {};\n  }\n\n  if (b === void 0) {\n    b = {};\n  }\n\n  return props.some(function (prop) {\n    return a[prop] !== b[prop];\n  });\n};\n\nvar observedNodes =\n/*#__PURE__*/\nnew Map();\nvar rafId;\n\nvar run = function run() {\n  var changedStates = [];\n  observedNodes.forEach(function (state, node) {\n    var newRect = node.getBoundingClientRect();\n\n    if (rectChanged(newRect, state.rect)) {\n      state.rect = newRect;\n      changedStates.push(state);\n    }\n  });\n  changedStates.forEach(function (state) {\n    state.callbacks.forEach(function (cb) {\n      return cb(state.rect);\n    });\n  });\n  rafId = window.requestAnimationFrame(run);\n};\n\nfunction observeRect(node, cb) {\n  return {\n    observe: function observe() {\n      var wasEmpty = observedNodes.size === 0;\n\n      if (observedNodes.has(node)) {\n        observedNodes.get(node).callbacks.push(cb);\n      } else {\n        observedNodes.set(node, {\n          rect: undefined,\n          hasRectChanged: false,\n          callbacks: [cb]\n        });\n      }\n\n      if (wasEmpty) run();\n    },\n    unobserve: function unobserve() {\n      var state = observedNodes.get(node);\n\n      if (state) {\n        // Remove the callback\n        var index = state.callbacks.indexOf(cb);\n        if (index >= 0) state.callbacks.splice(index, 1); // Remove the node reference\n\n        if (!state.callbacks.length) observedNodes[\"delete\"](node); // Stop the loop\n\n        if (!observedNodes.size) cancelAnimationFrame(rafId);\n      }\n    }\n  };\n}\n\nexport default observeRect;\n//# sourceMappingURL=observe-rect.esm.js.map\n","import React from 'react'\n\nexport default typeof window !== 'undefined'\n  ? React.useLayoutEffect\n  : React.useEffect\n","import React from 'react'\n\nimport observeRect from '@reach/observe-rect'\n\nimport useIsomorphicLayoutEffect from './useIsomorphicLayoutEffect'\n\nexport default function useRect(nodeRef, observe = true, onChange) {\n  const [, rerender] = React.useState()\n  const [rect, setRect] = React.useState(null)\n  const initialRectSet = React.useRef(false)\n  const onChangeRef = React.useRef(null)\n  onChangeRef.current = onChange\n\n  const element = nodeRef.current\n\n  useIsomorphicLayoutEffect(() => {\n    if (!element) {\n      requestAnimationFrame(() => {\n        rerender({})\n      })\n    }\n\n    let observer\n\n    if (element) {\n      observer = observeRect(element, function (rect) {\n        onChangeRef.current && onChangeRef.current(rect)\n        setRect(rect)\n      })\n    }\n\n    if (element && !initialRectSet.current) {\n      initialRectSet.current = true\n      setRect(element.getBoundingClientRect())\n    }\n\n    observer && observer.observe()\n\n    return () => {\n      observer && observer.unobserve()\n    }\n  }, [element, observe, onChange])\n  return rect\n}\n","import React from 'react'\n\nimport useScroll from './useScroll'\nimport useRect from './useRect'\nimport useIsomorphicLayoutEffect from './useIsomorphicLayoutEffect'\n\nexport function useVirtual({\n  size = 0,\n  estimateSize,\n  overscan = 0,\n  parentRef,\n  horizontal,\n  scrollToFn,\n}) {\n  const sizeKey = horizontal ? 'width' : 'height'\n  const scrollKey = horizontal ? 'scrollLeft' : 'scrollTop'\n\n  const defaultScrollToFn = React.useCallback(\n    offset => {\n      parentRef.current[scrollKey] = offset\n    },\n    [parentRef, scrollKey]\n  )\n\n  scrollToFn = scrollToFn || defaultScrollToFn\n\n  const { [sizeKey]: outerSize } = useRect(parentRef) || {\n    [sizeKey]: 0,\n  }\n\n  const [scrollOffset, _setScrollOffset] = React.useState(0)\n\n  useScroll(parentRef, ({ [scrollKey]: newScrollOffset }) => {\n    _setScrollOffset(newScrollOffset)\n  })\n\n  const scrollOffsetPlusOuterSize = scrollOffset + outerSize\n\n  const [measuredCache, setMeasuredCache] = React.useState({})\n\n  const mountedRef = React.useRef()\n\n  useIsomorphicLayoutEffect(() => {\n    if (mountedRef.current) {\n      if (estimateSize || size) setMeasuredCache({})\n    }\n    mountedRef.current = true\n  }, [estimateSize, size])\n\n  const measurements = React.useMemo(() => {\n    const measurements = []\n    for (let i = 0; i < size; i++) {\n      const start = measurements[i - 1]?.end || 0\n      const size = measuredCache[i] || estimateSize(i)\n      const end = start + size\n      measurements[i] = {\n        index: i,\n        start,\n        size,\n        end,\n      }\n    }\n\n    return measurements\n  }, [estimateSize, measuredCache, size])\n\n  const totalSize = measurements[size - 1]?.end || 0\n\n  let start = React.useMemo(\n    () => measurements.find(rowStat => rowStat.end >= scrollOffset),\n    [measurements, scrollOffset]\n  )\n  let end = React.useMemo(\n    () =>\n      [...measurements]\n        .reverse()\n        .find(rowStat => rowStat.start <= scrollOffsetPlusOuterSize),\n    [measurements, scrollOffsetPlusOuterSize]\n  )\n\n  let startIndex = start ? start.index : 0\n  let endIndex = end ? end.index : 0\n\n  // Always add at least one overscan item, so focus will work\n  startIndex = Math.max(startIndex - 1 - overscan, 0)\n  endIndex = Math.min(endIndex + 1 + overscan, size - 1)\n\n  const virtualItems = React.useMemo(() => {\n    const virtualItems = []\n\n    for (let i = startIndex; i <= endIndex; i++) {\n      const measurement = measurements[i]\n\n      const item = {\n        ...measurement,\n        measureRef: el => {\n          if (!el) return\n\n          const { [sizeKey]: measuredSize } = el.getBoundingClientRect()\n\n          if (measuredSize !== item.size) {\n            setMeasuredCache(old => ({\n              ...old,\n              [i]: measuredSize,\n            }))\n          }\n        },\n      }\n\n      virtualItems.push(item)\n    }\n\n    return virtualItems\n  }, [startIndex, endIndex, measurements, sizeKey])\n\n  const latestRef = React.useRef()\n  latestRef.current = {\n    outerSize,\n    scrollOffset,\n    scrollOffsetPlusOuterSize,\n    totalSize,\n  }\n\n  const scrollToOffset = React.useCallback(\n    (offset, { align = 'start' } = {}) => {\n      const {\n        outerSize,\n        scrollOffset,\n        scrollOffsetPlusOuterSize,\n        totalSize,\n      } = latestRef.current\n\n      offset = Math.max(0, Math.min(offset, totalSize - outerSize))\n\n      if (align === 'auto') {\n        if (offset <= scrollOffset) {\n          align = 'start'\n        } else if (offset >= scrollOffsetPlusOuterSize) {\n          align = 'end'\n        } else {\n          align = 'start'\n        }\n      }\n\n      if (align === 'start') {\n        scrollToFn(offset)\n      } else if (align === 'end') {\n        scrollToFn(offset - outerSize)\n      } else if (align === 'center') {\n        scrollToFn(offset - outerSize / 2)\n      }\n    },\n    [scrollToFn]\n  )\n\n  const getIndexOffset = React.useCallback(\n    (index, { align = 'start' } = {}) => {\n      const measurement = measurements[index]\n\n      if (!measurement) {\n        return\n      }\n\n      if (align === 'auto') {\n        if (measurement.end >= scrollOffsetPlusOuterSize) {\n          align = 'end'\n        } else {\n          align = 'start'\n        }\n      }\n\n      let offset =\n        align === 'center'\n          ? measurement.start + measurement.size / 2\n          : align === 'end'\n          ? measurement.end\n          : measurement.start\n\n      return offset\n    },\n    [measurements, scrollOffsetPlusOuterSize]\n  )\n\n  const scrollToIndex = React.useCallback(\n    (index, options) => {\n      const offset = getIndexOffset(index, options)\n      if (typeof offset !== 'undefined') {\n        scrollToOffset(offset, options)\n      }\n    },\n    [getIndexOffset, scrollToOffset]\n  )\n\n  return {\n    virtualItems,\n    totalSize,\n    getIndexOffset,\n    scrollToOffset,\n    scrollToIndex,\n  }\n}\n"],"names":["useScroll","ref","onChange","onChangeRef","React","useRef","current","useEffect","el","handler","e","scrollLeft","target","scrollTop","addEventListener","capture","passive","removeEventListener","props","rectChanged","b","observedNodes","run","changedStates","newRect","node","state","rafId","window","observeRect","cb","observe","wasEmpty","rect","hasRectChanged","callbacks","unobserve","index","cancelAnimationFrame","useLayoutEffect","useRect","nodeRef","useState","rerender","setRect","initialRectSet","element","useIsomorphicLayoutEffect","requestAnimationFrame","observer","getBoundingClientRect","useVirtual","size","estimateSize","overscan","parentRef","horizontal","scrollToFn","sizeKey","scrollKey","defaultScrollToFn","useCallback","offset","outerSize","scrollOffset","_setScrollOffset","newScrollOffset","scrollOffsetPlusOuterSize","measuredCache","setMeasuredCache","mountedRef","measurements","useMemo","i","start","end","totalSize","find","rowStat","reverse","startIndex","endIndex","Math","max","min","virtualItems","measurement","item","measureRef","measuredSize","old","push","latestRef","scrollToOffset","align","getIndexOffset","scrollToIndex","options"],"mappings":"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"}